Maintenance Page
################

Repository
==========

The script is hosted as a gitlab repository and be available under https://gitlab.com/toccoag/maintenance-page/

The customer themes are hosted as a separated gitlab repository https://gitlab.com/toccoag/maintenance-page-customer .
The default branch is the fallback if no customer branch exists.

Usage
=====

Initially clone the repository (``git clone https://gitlab.com/toccoag/maintenance-page.git``) and move to the created directory (e.g. ``cd somewhere/maintenance-page``).

1. Login ``oc login``
2. Go to the project where the maintenance page should be deployed (e.g. ``oc project toco-nice-master``)
3. Enable maintenance page ``./mntnc start [-c tocco] [-t "24.12.2020 6:00"] [-r 1]``

The following optional arguments are supported:

* ``-c``/``--customer``: branch picked of repository where the customer theme is defined. If no argument is passed or the branch does not exist the default branch is taken.
* ``-t``/``--till``: date/time until the application is unavailable If the argument is present, the message is *Please try again on [date/time]*. Else the more generic message *Please try again later.* is shown.
* ``-r``/``--replicas``: number of replicas deployed (default: ``1``)

4. Disable/enable bypass as needed via https://master.tocco.ch/_maintenance/bypass/
5. Disable maintenance page ``./mntnc stop``

Theme
=====

If a customer wants a custom theme, a new git branch should be created.

The ``index.html`` file should meet the following requirements:

* the no robot tag should be present (``<meta name="robots" content="noindex, nofollow">``)
* The placeholders ``{{{TEXT_DE}}}``, ``{{{TEXT_EN}}}``, ``{{{TEXT_FR}}}`` and ``{{{TEXT_IT}}}`` should be used somewhere in the body. The are generated by the ``mntnc`` command.